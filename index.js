"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function initMap(){console.log("init route");var e=config$1.getConfig().controllerDir;console.assert(fs.existsSync(e),"controller filepath may need to be set, default:"+e),fs.readdirSync(e).forEach(function(r){var o=r.match(/([a-zA-Z0-9]+)Controller.js/);if(o){console.log(r);var t=require(path.resolve(e,r));controllerMap.set(o[1].toLocaleLowerCase(),new t)}})}function Router(e,r,o){controllerMap.size||initMap();var t=e.path.slice(1)||"index";if(/^\d+$/.test(t))return o();var n=t.split("/"),i=toArray(n),a=i[0],s=void 0===a?"index":a,f=i[1],l=void 0===f?"index":f,c=i.slice(2),p=controllerMap.get(s);if(!p)return o();p.req=e,p.res=r;var u=p[l];if(!u)return o();p.__before&&p.__before.apply(p),u.apply(p,c),p.__after&&p.__after.apply(p)}Object.defineProperty(exports,"__esModule",{value:!0});var fs=_interopDefault(require("fs")),path=_interopDefault(require("path")),process=require("process"),config={controllerDir:path.resolve(process.cwd(),"src/controller")},config$1={setConfig:function(e){Object.assign(config,e)},getConfig:function(){return config}},toArray=function(e){return Array.isArray(e)?e:Array.from(e)},controllerMap=new Map,setConfig=config$1.setConfig;exports.Router=Router,exports.setConfig=setConfig;
